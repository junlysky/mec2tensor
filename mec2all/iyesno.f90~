SUBROUTINE IYESNO(MSG,IANS)
!implicit none

!C     PURPOSE:
!C	     THIS LITTLE SUBROUTINE ASKS A QUESTION AND RETURNS A
!C	     RESPONSE TO THAT QUESTION. THE ANSWER TO THE QUESTION
!C	     MUST BE EITHER 'Y' FOR YES, 'N' FOR NO, OR NOTHING
!C	     (i.e. simply hitting carrage return) FOR THE DEFAULT
!C	     REPONSE TO THE QUESTION.
!C
!C     ON INPUT:
!C	    MSG = BYTE STRING CONTAINING THE QUESTION
!C
!C     ON OUTPUT:
!C	    IANS = THE LOGICAL REPONSE TO THE QUESTION (1 or 0)
!C     EXTRA FEATURES:
!C	    DEFAULT SITUATION IS:
!C	    IF LAST 3 CHARACTERS IN 'MSG' ARE
!C	  	     [Y]  OR  [N]
!C	    THEN 'IANS' = 1   OR   0
!C
!C	    IF LAST 3 CHARACTERS ARE NOT ONE OF ABOVE PAIRS
!C	    THEN 'IANS' = 0
!C	    (i.e. default for no supplied default is N)
!C	30 JULY 1989:  IF ENTERED CHARACTER IS A BLANK OR A TAB, 
!C	    TREATS AS A NULL ENTRY.
!C       27 July 1993: Did input read through cstring so can have 
!C         comment lines
!C-
CHARACTER*1 DELIM/'$'/,CHARIN,BLANK/' '/
CHARACTER*3 TEST,UCY,LCY
character*80 string_in
CHARACTER*(*) MSG



DATA UCY/'[Y]'/,LCY/'[y]'/
KK = LEN(MSG)
IF (MSG(KK:KK) .EQ. DELIM) KK = KK - 1
TEST = MSG(KK-2:KK)
CALL PRINTX(MSG)
call cstring(string_in,nchar)
IF ((NCHAR.GT.0) .AND. (string_in(1:1).EQ.BLANK)) NCHAR = 0
IF (NCHAR .EQ. 0) THEN
   IF ((TEST .EQ. UCY) .OR. (TEST .EQ. LCY)) THEN
      IANS = 1
   ELSE 
      IANS = 0
   END IF
ELSE
   charin = string_in(1:1)
   IF (CHARIN .EQ. UCY(2:2) .OR. CHARIN .EQ. LCY(2:2)) THEN
      IANS = 1
   ELSE
      IANS = 0
   END IF
END IF
RETURN
END SUBROUTINE IYESNO
